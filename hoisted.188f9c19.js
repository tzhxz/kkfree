import"./chunks/Layout.astro_astro_type_script_index_3_lang.641a2333.js";import{C as i}from"./chunks/permission.623ab746.js";let w=class{gameFrame=document.getElementById("gameFrame");startBox=document.getElementById("startBox");gInfoEle=document.getElementById("gInfoEle");topPd=16;tryAdTimes=0;gameData={isPreGameboxZoom:!1,isShowAdFlex:!1,isFullScreen:!1,isShowGame:!1,isShowFeedBack:!1,url:this.gInfoEle.getAttribute("data-url"),orientation:this.gInfoEle.getAttribute("data-orientation"),gid:this.gInfoEle.getAttribute("data-gid"),gameBoxInfo:{hw:393,hh:851,vw:732,vh:440,fth:61}};constructor(){this.init()}init(){i.gAdpBreak({preloadAdBreaks:"auto"}),this.initKeyDownEvent(),this.initPlayGame(),this.initRecomdData(),window.playGame=()=>{this.playGame()},window.switchFullScreen=()=>{this.switchFullScreen()},window.onscroll=()=>{this.navPosition()},i.initPwaInstall({btnId:"pcGamePwaInstall"})}initRecomdData(){const t="plf,prh,pbt,pbt2";i.axios({url:"index/getRecommendGameList",data:{name:t},success:e=>{let n=e.plf.games,r=e.prh.games,c=e.pbt.games,h=e.pbt2.games,y=n.length>6?n.slice(0,6):n,u=r.length>6?r.slice(0,6):r,p=9,d=this.gameData.orientation==1?6:5,f=document.getElementById("recomLeftDiv"),B=document.getElementById("adFixLeft"),a="";if(y.slice(0,d).map((o,s)=>{let l=document.createElement("a");l.setAttribute("class","grid-a box-shadow wh94 mtp-8"),l.setAttribute("href",i.getHomePathByCalc(s)+"/g/"+o.gid+"/"),s==0&&l.setAttribute("style","margin-top:0;");let m=document.createElement("img");m.setAttribute("class","grid-a-img"),m.setAttribute("src",o.icon),m.setAttribute("loading","async"),l.append(m);let g=document.createElement("span");g.setAttribute("class","title grid-a-title"),g.append(o.title),l.append(g),f.append(l),a+=' <a class="grid-a box-shadow wh94 mtp-8" ',a+="href=/g/"+o.gid+"/",s==0&&(a+=' style="margin-top:0"'),a+="><img src="+o.icon+' loading="eager" decoding="async"  class="grid-a-img"/> <span class="title grid-a-title">'+o.title+"</span></a>"}),B.innerHTML=a,a="",u.length){let o=document.getElementById("recomRightDiv"),s=document.getElementById("adFixRight");a+=i.creatGridaHtml({list:u.slice(0,d),aClass:"grid-a box-shadow wh94 mtp-8",modNum:d,modStye:' style="margin-top:0"'}),s.innerHTML=o.innerHTML=a}if(a="",c.length){let o=document.getElementById("recomBottomDiv");a+=i.creatGridaHtml({list:c,isNo3w:1,modNum:p,modStye:' style="margin-left:0"'}),o.innerHTML=a}if(a="",h.length){let o=document.getElementById("recomBottom2Div");a+=i.creatGridaHtml({list:h,modNum:p,modStye:' style="margin-left:0"'}),o.innerHTML=a}},fail:e=>{console.log(e)}})}navPosition(){let t=document.getElementById("video-box").offsetTop||0;if(!t)return;let e=document.getElementById("navBar");i.eleNoScroll({element:e,offsetTop:t-e.clientHeight,oldTop:16,newTop:94,scrollType:0})}showAdpBreak(){if(this.tryAdTimes>2)return;let t=this;i.gAdpBreak({type:"preroll",name:"app_start",adBreakDone:e=>{console.log("====dbg===pcPreAd=breakStatus",e.breakStatus),e.breakStatus==="notReady"&&setTimeout(()=>{t.tryAdTimes++,t.showAdpBreak()},1e3)}})}playGame(){console.log("==debug==playGame==")}addPlayHistory(){i.axios({url:"/user/addPlayHistory",data:{gid:this.gameData.gid},success:t=>{},fail:t=>{console.log(t)}})}switchFullScreen(){if(console.log(this.gameData.orientation+"==debug====",this.gameData.url),this.gameData.isFullScreen=!this.gameData.isFullScreen,this.gameData.isFullScreen){let t=window.innerHeight-this.gameData.gameBoxInfo.fth,e=this.gameData.orientation==1?parseInt(t*(this.gameData.gameBoxInfo.hw/this.gameData.gameBoxInfo.hh)):parseInt(t*(this.gameData.gameBoxInfo.vw/this.gameData.gameBoxInfo.vh)),n=(window.innerWidth-e)/2;this.setCssProperty("--game_box_position","absolute"),this.setCssProperty("--game_box_left",n+"px"),document.getElementById("fullBg").style.display="block",document.getElementById("iconVideo").style.display="none",document.getElementById("iconFullScreen").setAttribute("src","/img/icon_s.png"),this.reSetPlayGamebox(t,e),window.scrollTo(0,0),this.resetRecomendFloatAd("block"),document.documentElement.style.overflow="hidden"}else this.exitFullScreen()}exitFullScreen(){this.resetRecomendFloatAd("none"),document.documentElement.style.overflow="",document.getElementById("fullBg").style.display="none",document.getElementById("iconVideo").style.display="block",document.getElementById("iconFullScreen").setAttribute("src","/img/icon_d.png"),this.gameData.isFullScreen=!1,this.setCssProperty("--game_box_position","static"),this.initPlayGame()}setCssProperty(t,e){document.documentElement.style.setProperty(t,e)}reSetPlayGamebox(t,e){this.setCssProperty("--game_box_w",e+"px"),this.setCssProperty("--game_box_h",t+"px")}resetRecomendFloatAd(t){document.getElementById("adFixLeft").style.display=t,document.getElementById("adFixRight").style.display=t}initPlayGame(){let t=window.innerHeight,e=this.gameData.orientation==1?this.gameData.gameBoxInfo.hh:this.gameData.gameBoxInfo.vh;e=e>t-this.gameData.gameBoxInfo.fth?t-this.gameData.gameBoxInfo.fth:e;let n=this.gameData.orientation==1?parseInt(e*(this.gameData.gameBoxInfo.hw/this.gameData.gameBoxInfo.hh)):parseInt(e*(this.gameData.gameBoxInfo.vw/this.gameData.gameBoxInfo.vh));this.reSetPlayGamebox(e,n)}initKeyDownEvent(){document.onkeydown=function(t){var e=t||window.event||arguments.callee.caller.arguments[0];e&&e.keyCode==27&&this.gameData.isFullScreen&&this.exitFullScreen()}.bind(this)}};new w;
