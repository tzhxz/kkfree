var c=window.localStorage;function w(e){return e=JSON.stringify(e),!!/^\{[\s\S]*\}$/.test(e)}function P(e){return e===void 0||typeof e=="function"?e+"":JSON.stringify(e)}function v(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}}function y(e){return{}.toString.call(e)==="[object Function]"}function x(e){return Object.prototype.toString.call(e)==="[object Array]"}function E(e){var t="_Is_Incognit",n="yes";try{e.setItem(t,n)}catch(o){if(o.name==="QuotaExceededError"){var r=function(){};e.__proto__={setItem:r,getItem:r,removeItem:r,clear:r}}}finally{e.getItem(t)===n&&e.removeItem(t)}return e}c=E(c);function h(){if(!(this instanceof h))return new h}h.prototype={set:function(t,n){if(t&&!w(t))c.setItem(t,P(n));else if(w(t))for(var r in t)this.set(r,t[r]);return this},get:function(t){if(!t){var n={};return this.forEach(function(s,m){return n[s]=m}),n}if(t.charAt(0)==="?")return this.has(t.substr(1));var r=arguments;if(r.length>1){for(var o={},i=0,l=r.length;i<l;i++){var a=v(c.getItem(r[i]));this.has(r[i])&&(o[r[i]]=a)}return o}return v(c.getItem(t))},clear:function(){return c.clear(),this},remove:function(t){var n=this.get(t);return c.removeItem(t),n},has:function(t){return{}.hasOwnProperty.call(this.get(),t)},keys:function(){var t=[];return this.forEach(function(n){t.push(n)}),t},forEach:function(t){for(var n=0,r=c.length;n<r;n++){var o=c.key(n);t(o,this.get(o))}return this},search:function(t){for(var n=this.keys(),r={},o=0,i=n.length;o<i;o++)n[o].indexOf(t)>-1&&(r[n[o]]=this.get(n[o]));return r}};var u=null;function f(e,t){var n=arguments,r=null;if(u||(u=h()),n.length===0)return u.get();if(n.length===1){if(typeof e=="string")return u.get(e);if(w(e))return u.set(e)}if(n.length===2&&typeof e=="string"){if(!t)return u.remove(e);if(t&&typeof t=="string")return u.set(e,t);t&&y(t)&&(r=null,r=t(e,u.get(e)),f.set(e,r))}if(n.length===2&&x(e)&&y(t))for(var o=0,i=e.length;o<i;o++)r=t(e[o],u.get(e[o])),f.set(e[o],r);return f}for(var S in h.prototype)f[S]=h.prototype[S];let d={webTitle:"kkfreegame Studios| Free mobile & Browser games",ver:"240227.1",apiHost:"https://api.joyheartstudio.com/",apiMould:"apps/oliogame/v1/",appid:10,mAppid:10,prefix:"Joyheart-",gAdConfig:{client:"",afc:{pcLeftSlot:"7247427520",pcRightSlot:"4366113319",pcMidSlot:"9036858207",pcFlexRight1:"1158368187",pcFlexRight2:"5160190357",pcCateMidSlot:"4393903596",mHomeSlot:"9634133668",mDetailSlot:"6062154586"}}},T=class{userInfo={token:"",is_new:null,email:""};serialize(e={}){let t="";return Object.keys(e).forEach(n=>{let r=e[n];r=typeof e[n]=="object"?JSON.stringify(r):r,t+=`&${n}=${r}`}),t.slice(1)}request(e){e=Object.assign({url:"",data:{},dataSign:!0,method:"POST",header:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},success:null,fail:null},e||{});let t=d.prefix+"Access-Token";if(e.header[t]="",e.url=="")return console.error("url is need");e.url=d.apiHost+d.apiMould+e.url;const n=this.serialize(e.data);let r={method:e.method,cache:"no-cache",headers:e.header,mode:"cors",redirect:"follow"};e.method==="GET"?e.url+="?"+n:r.body=n,fetch(e.url,r).then(o=>{let i=o.status;if(i&&i>=200&&i<400)return o.json();{let l=new Error(o.statusText);throw l.response=o,l.statusCode=o.status,l}}).then(o=>{if(o.code==1)e.success&&e.success(o.data);else{let i=new Error(o.statusText);throw i.response=o,i.statusCode=o.status,i}}).catch(o=>{e.fail&&e.fail(o)})}axios(e){e.data.appid=d.appid,this.request(e)}mAxios(e){e.data.appid=d.mAppid,e.data.client_type="m",this.request(e)}localSet(e,t){e=d.prefix+e,f.set(e,t)}localGet(e){return e=d.prefix+e,f.get(e)}randomSort(e){let t=e.length;if(!(!Array.isArray(e)||t<=1)){for(let n=0;n<t-1;n++){let r=Math.floor(Math.random()*(t-n))+n;[e[n],e[r]]=[e[r],e[n]]}return e}}loging(e){this.request({url:"/index/loginin",data:{appid:e},success:t=>{if(console.log("==debug==permission==loginin==res:",t),t.userinfo){let n=Object.assign({time:Date.now()},t.userinfo||{});console.log("==debug==permission==request==token:",t.userinfo.token),this.localSet("userInfo",n)}},fail:t=>{}})}checkToken(){let e=this.localGet("userInfo");if(!e)return!1;let t=1e3*60*60*12;return Date.now()-e.time>t?!1:e.token}urlBase64ToUint8Array(e){const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),o=new Uint8Array(r.length);for(let i=0;i<r.length;++i)o[i]=r.charCodeAt(i);return o}initFontSize(){let e=this.getFontSize();document.documentElement.style.fontSize=e+"px"}getFontSize(){let e=750;var t=window.screen.width;return t>e&&(t=e),t<320&&(t=320),t*2/(e/100)}setCssProperty(e,t){document.documentElement.style.setProperty(e,t)}initNavBar(){let e=document.getElementById("navBar");if(!e)return 0;let t=e.getBoundingClientRect().width,r=(this.clientWidth()-3*t)/4;r=r<0?0:r,this.setCssProperty("--nav_left",r+"px")}clientWidth(){return document.documentElement.clientWidth||document.body.clientWidth||window.screen.width}clientHeight(){return document.documentElement.clientHeight||document.body.clientHeight||window.screen.height}deviceOrientation(){return this.clientWidth()>this.clientHeight()}eleNoScroll(e){if(!e.element)return;let t=e.offsetTop;if(!t)return;let n=document.body.scrollTop||document.documentElement.scrollTop;if(n>t)e.element.style.top=-e.newTop+"px";else{let r=e.oldTop;e.scrollType&&(r-=n),e.element.style.top=r+"px"}}initPwaInstall(e){let t=document.getElementById(e.btnId);!t||(e.isMove&&this.initMoveStart({element:t,position:e.position}),t.style.display="none",window.addEventListener("beforeinstallprompt",n=>{n.preventDefault();let r=n;t&&(t.style.display="",e.call&&e.call(),t.addEventListener("click",o=>{t.style.display="none",r.prompt(),r.userChoice.then(i=>{console.log(i),i.outcome,r=null})}))}))}initMoveStart(e){if(!e.element)return;var t={deviation:{x:null,y:null}};let n=o=>{var i=o.targetTouches[0];t.deviation.y=i.pageY-e.element.offsetTop},r=o=>{if(o.targetTouches.length!=1)return;o.stopPropagation(),o.preventDefault();let i=o.targetTouches[0],l=i.pageY-t.deviation.y<0?0:i.pageY-t.deviation.y,a=window.innerHeight;0<l&&(l=i.pageY-t.deviation.y>a-e.element.offsetHeight?a-e.element.offsetHeight:i.pageY-t.deviation.y),e.position==1?e.element.style.right="0px":e.element.style.left="0px",e.element.style.top=l+"px"};e.element.addEventListener("touchstart",n),e.element.addEventListener("touchmove",r)}getHomePath(e=0){return window.origin.indexOf("https://")!=0?"":e?"https://kkfreegame.com":"https://www.kkfreegame.com"}getPrePath(e,t){let n=this.getHomePathByCalc(t),r=e=="m"?"/m":"";return n+r}getHomePathByCalc(e){return""}creatGridaHtml(e){e=Object.assign({list:[],aClass:"grid-a box-shadow wh94",modNum:0,modStye:'style="margin-left:0"',add_a_n:0,isNo3w:0,add_a_h:"1px"},e||{});let t="";e.list.map((n,r)=>{let o=this.getPrePath(e.appType,r);t+=' <a class="'+e.aClass+'" ',t+="href="+o+"/g/"+n.gid+"/ ",r%e.modNum==0&&(t+=e.modStye+" "),t+="><img src="+n.icon+' loading="eager" decoding="async"  class="grid-a-img"/> <span class="title grid-a-title">'+n.title+"</span></a>"});for(let n=0;n<e.add_a_n;n++)t+='<a class="wh94" style="height: '+e.add_a_h+';"></a>';return t}gAdpBreak(e){window.adsbygoogle.push(e)}gtagReport(e){if(e=Object.assign({name:"",label:null,category:null,value:null,delaytime:100},e||{}),!window.KyGtagReport||!e.name)return;let t={eventName:e.name,eventParams:{event_category:e.category,event_label:e.label.replaceAll("-",""),value:e.value}};setTimeout(()=>{window.KyGtagReport(t)},e.delaytime)}};const g=new T;console.log("==debug==permission==start:",window.origin);let b=d.appid;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(b=d.mAppid);(function(){function e(i){return navigator.serviceWorker.register(i,{updateViaCache:"none"})}function t(i,l){var a={userVisibleOnly:!0,applicationServerKey:g.urlBase64ToUint8Array(l)};return i.pushManager.subscribe(a).then(function(s){return console.log("==dbg==Received PushSubscription: ",JSON.stringify(s)),s})}function n(i,l=""){let a=g.localGet("endpoint");return l=l||"user/addUserPushUrl",new Promise(function(s,m){if(i.endpoint==a){s(1);return}g.request({data:{appid:b,url:JSON.stringify(i)},url:l,success:p=>{g.localSet("endpoint",i.endpoint),s(p)},fail:p=>{m(p)}})})}if("serviceWorker"in navigator&&"PushManager"in window){var r="BMsgUVumb3QV-mZjE6YBPOr1eyu4Ygy1r5iFc-KqlUn_p0P4LCMlsb_KcjSUGckVp4acz5DaDVExJW_eLPQpd0w";e("/sw_1.0.0.js").then(function(i){return i.addEventListener("updatefound",function(){console.log("Value of updateViaCache:",i.updateViaCache)}),Promise.all([i,o()])}).then(function(i){var l=i[0];return console.log("==dbg==Permission==Service Worker \u6CE8\u518C\u6210\u529F"),t(l,r)}).then(function(i){return n(i)}).then(function(i){}).catch(function(i){})}function o(){return new Promise(function(i,l){var a=Notification.requestPermission(function(s){i(s)});a&&a.then(i,l)}).then(function(i){if(i!=="granted")throw new Error("We weren't granted permission.")})}})();export{g as C};
